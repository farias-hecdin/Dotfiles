local a=require"util.bench"local b={"../json.lua","dkjson.lua","jfjson.lua","json4lua.lua"}local c={}for d=1,1000 do table.insert(c,{firstName="John",lastName="Smith",isAlive=true,age=25,address={streetAddress="21 2nd Street",city="New York",state="NY",postalCode="10021-3100"},phoneNumbers={{type="home",number="212 555-1234"},{type="office",number="646 555-4567"}},children={},spouse=nil})end;local e={}for d,f in ipairs(b)do local g=loadfile(f)if not g then error("failed to load '"..f.."'; run './get_json_libs.sh'")end;local h=g()if f=="jfjson.lua"then local i,j=h.encode,h.decode;h.encode=function(...)return i(h,...)end;h.decode=function(...)return j(h,...)end end;a.run(f,1,function()h.encode(c)end)local k=a.run(f,10,function()h.encode(c)end)table.insert(e,k)end;a.print_system_info()a.print_results(e)
