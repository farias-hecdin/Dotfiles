local a={}a.index={}a.index_node=function(b,c,d,e,f)local g=string.format('%s%s',b,d.type and'/'or d.contents[1].text)if e==nil or e(d)then a.index[#a.index+1]={path=g,parent=c,node=d}end;if d.children~=nil then local h=d.type and g or g..'/'for i,j in ipairs(d.children)do a.index_node(h,d,j,e,f)end end end;a.index_tree=function(k,e,f)a.index={}a.index_node('',nil,k,e,f)end;a.search_index=function(k,l,e,m,f)local n=function(o)local p=''if o.node.data~=nil then p=f.ui.data_marker elseif o.node.url~=nil then p=f.ui.url_marker end;return p..o.path end;a.index_tree(k,e,f)vim.ui.select(a.index,{prompt=l,format_item=n},function(o)if o~=nil then m(o)end end)end;return a
