local a=vim.api;local b,c;local d={}local e=1;local function f()b=a.nvim_create_buf(false,true)local g=a.nvim_create_buf(false,true)a.nvim_buf_set_option(b,'bufhidden','wipe')a.nvim_buf_set_option(b,'filetype','bufferlist')local h=a.nvim_get_option("columns")local i=a.nvim_get_option("lines")local j=math.ceil(i*0.5-4)local k=math.ceil(h*0.4)local l=math.ceil((i-j)/2-1)local m=math.ceil((h-k)/2)local n={style='minimal',relative='editor',width=k+2,height=j+2,row=l-1,col=m-1}local o={style='minimal',relative='editor',width=k,height=j,row=l,col=m}local p=' Quick Navigation 'local q={'╭'..p..string.rep('─',k-string.len(p))..'╮'}local r='│'..string.rep(' ',k)..'│'for s=1,j do table.insert(q,r)end;table.insert(q,'╰'..string.rep('─',k)..'╯')a.nvim_buf_set_lines(g,0,-1,false,q)local t=a.nvim_open_win(g,true,n)c=a.nvim_open_win(b,true,o)a.nvim_command('au BufWipeout <buffer> exe "silent bwipeout! "'..g)a.nvim_win_set_option(c,'cursorline',true)end;local function u()local v=a.nvim_buf_get_name(0)table.insert(d,v)end;local function w()a.nvim_buf_set_option(b,'modifiable',true)a.nvim_buf_set_lines(b,0,-1,false,d)a.nvim_buf_set_option(b,'modifiable',true)end;local function x()d={}local y=a.nvim_buf_get_lines(b,0,-1,false)if#y~=0 then for s,z in ipairs(y)do if z~=''then table.insert(d,z)end end end end;local function A()x()a.nvim_win_close(c,true)end;local function B()local C=a.nvim_get_current_line()A()a.nvim_command('edit '..C)end;local function D()local E=math.max(4,a.nvim_win_get_cursor(c)[1]-1)a.nvim_win_set_cursor(c,{E,0})end;local function F()local G={['<esc>']='close_window()',['<cr>']='go_to_file()'}for H,I in pairs(G)do a.nvim_buf_set_keymap(b,'n',H,':lua require"nvim-quicknav".'..I..'<cr>',{nowait=true,noremap=true,silent=true})end end;local function J(K)if K=='next'then if e<#d then e=e+1 else e=1 end else if e>#d then e=#d elseif e>1 then e=e-1 else e=#d end end;return e end;local function L()local M=J('next')vim.cmd('edit '..d[M])end;local function N()local M=J('prev')vim.cmd('edit '..d[M])end;local function O()f()w()F()a.nvim_win_set_cursor(c,{1,0})end;return{quicknav=O,add_current_file=u,update_view=w,go_to_file=B,move_cursor=D,close_window=A,go_to_next_file=L,go_to_prev_file=N}
