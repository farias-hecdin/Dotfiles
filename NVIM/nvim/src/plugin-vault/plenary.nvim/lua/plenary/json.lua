local a="singleComment"local b="multiComment"local c=function()return""end;local function d(e,f,g)f=f or 1;g=g or#e;return e:sub(f,g)end;local h=function(e,f,g)return d(e,f,g):gsub("%S"," ")end;local i=function(j,k)local l=k-1;local m=0;while j:sub(l,l)=="\\"do l=l-1;m=m+1 end;return m%2==1 and true or false end;local n={}function n.json_strip_comments(j,o)o=o or{}local p=o.whitespace==false and c or h;local q=false;local r=false;local s=1;local t=""local u=false;for v=1,#j,1 do if u then u=false else local w=j:sub(v,v)local x=j:sub(v+1,v+1)if not r and w=='"'then local y=i(j,v)if not y then q=not q end end;if not q then if not r and w..x=="//"then t=t..d(j,s,v-1)s=v;r=a;u=true elseif r==a and w..x=="\r\n"then v=v+1;u=true;r=false;t=t..p(j,s,v-1)s=v elseif r==a and w=="\n"then r=false;t=t..p(j,s,v-1)s=v elseif not r and w..x=="/*"then t=t..d(j,s,v-1)s=v;r=b;u=true elseif r==b and w..x=="*/"then v=v+1;u=true;r=false;t=t..p(j,s,v)s=v+1 end end end end;return t..(r and p(d(j,s))or d(j,s))end;return n
