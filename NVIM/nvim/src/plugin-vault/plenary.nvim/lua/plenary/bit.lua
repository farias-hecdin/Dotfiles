if bit then return bit end;local a={_TYPE='module',_NAME='bit.numberlua',_VERSION='0.3.1.20120131'}local b=math.floor;local c=2^32;local d=c-1;local function e(f)local g={}local h=setmetatable({},g)function g:__index(i)local j=f(i)h[i]=j;return j end;return h end;local function k(h,l)local function m(n,o)local p,q=0,1;while n~=0 and o~=0 do local r,s=n%l,o%l;p=p+h[r][s]*q;n=(n-r)/l;o=(o-s)/l;q=q*l end;p=p+(n+o)*q;return p end;return m end;local function t(h)local u=k(h,2^1)local v=e(function(n)return e(function(o)return u(n,o)end)end)return k(v,2^(h.n or 1))end;function a.tobit(w)return w%2^32 end;a.bxor=t{[0]={[0]=0,[1]=1},[1]={[0]=1,[1]=0},n=4}local x=a.bxor;function a.bnot(n)return d-n end;local y=a.bnot;function a.band(n,o)return(n+o-x(n,o))/2 end;local z=a.band;function a.bor(n,o)return d-z(d-n,d-o)end;local A=a.bor;local B,C;function a.rshift(n,D)if D<0 then return B(n,-D)end;return b(n%2^32/2^D)end;C=a.rshift;function a.lshift(n,D)if D<0 then return C(n,-D)end;return n*2^D%2^32 end;B=a.lshift;function a.tohex(w,E)E=E or 8;local F;if E<=0 then if E==0 then return''end;F=true;E=-E end;w=z(w,16^E-1)return('%0'..E..(F and'X'or'x')):format(w)end;local G=a.tohex;function a.extract(E,H,I)I=I or 1;return z(C(E,H),2^I-1)end;function a.replace(E,j,H,I)I=I or 1;local J=2^I-1;j=z(j,J)local K=y(B(J,H))return z(E,K)+B(j,H)end;function a.bswap(w)local n=z(w,0xff)w=C(w,8)local o=z(w,0xff)w=C(w,8)local L=z(w,0xff)w=C(w,8)local M=z(w,0xff)return B(B(B(n,8)+o,8)+L,8)+M end;local N=a.bswap;function a.rrotate(w,D)D=D%32;local O=z(w,2^D-1)return C(w,D)+B(O,32-D)end;local P=a.rrotate;function a.lrotate(w,D)return P(w,-D)end;local Q=a.lrotate;a.rol=a.lrotate;a.ror=a.rrotate;function a.arshift(w,D)local R=C(w,D)if w>=0x80000000 then R=R+B(2^D-1,32-D)end;return R end;local S=a.arshift;function a.btest(w,T)return z(w,T)~=0 end;a.bit={}function a.bit.tobit(w)w=w%c;if w>=0x80000000 then w=w-c end;return w end;local U=a.bit.tobit;function a.bit.tohex(w,...)return G(w%c,...)end;function a.bit.bnot(w)return U(y(w%c))end;local function V(n,o,L,...)if L then return V(V(n,o),L,...)elseif o then return U(A(n%c,o%c))else return U(n)end end;a.bit.bor=V;local function W(n,o,L,...)if L then return W(W(n,o),L,...)elseif o then return U(z(n%c,o%c))else return U(n)end end;a.bit.band=W;local function X(n,o,L,...)if L then return X(X(n,o),L,...)elseif o then return U(x(n%c,o%c))else return U(n)end end;a.bit.bxor=X;function a.bit.lshift(w,E)return U(B(w%c,E%32))end;function a.bit.rshift(w,E)return U(C(w%c,E%32))end;function a.bit.arshift(w,E)return U(S(w%c,E%32))end;function a.bit.rol(w,E)return U(Q(w%c,E%32))end;function a.bit.ror(w,E)return U(P(w%c,E%32))end;function a.bit.bswap(w)return U(N(w%c))end;return a.bit
