local a={}local b={window_open=false}local c=require("search-replace.util")local d,e;local function f(g,h,i,j,k)local l=""if g=="single"then l="require('search-replace.single-buffer').search_replace"elseif g=="multi"then l="require('search-replace.multi-buffer').search_replace"end;local m={w=l.."('"..h.."')",e=l.."('"..i.."')",f=l.."('"..j.."')",W=l.."('"..k.."')"}for n,o in pairs(m)do vim.api.nvim_buf_set_keymap(d,"n",n,':lua require("search-replace.ui").close()<cr> | :lua '..o.."<cr>",{nowait=true,noremap=true,silent=true})end;vim.api.nvim_buf_set_keymap(d,"n","q",":lua require('search-replace.ui').close()<cr>",{nowait=true,noremap=true,silent=true})end;local function p()if b["window_open"]then print("search-replace selections window already open")return end;b["window_open"]=true;vim.api.nvim_command("5split +enew")e=vim.api.nvim_get_current_win()d=vim.api.nvim_get_current_buf()vim.api.nvim_buf_set_name(d,"SearchReplace selections")vim.api.nvim_set_option_value("wrap",false,{win=e})vim.api.nvim_set_option_value("cursorline",false,{win=e})vim.api.nvim_set_option_value("number",false,{win=e})vim.api.nvim_set_option_value("relativenumber",false,{win=e})vim.api.nvim_set_option_value("buftype","nofile",{buf=d})vim.api.nvim_set_option_value("swapfile",false,{buf=d})vim.api.nvim_set_option_value("bufhidden","wipe",{buf=d})vim.api.nvim_set_option_value("filetype","nvim-search-replace",{buf=d})vim.api.nvim_set_option_value("modifiable",false,{buf=d})end;a.close=function()if e and vim.api.nvim_win_is_valid(e)then vim.api.nvim_win_close(e,true)end;b["window_open"]=false end;local function q(g)local h=vim.fn.expand("<cword>")local i=vim.fn.expand("<cexpr>")local j=vim.fn.expand("<cfile>")local k=vim.fn.expand("<cWORD>")p()f(g,h,i,j,k)local r={}table.insert(r,#r+1,"[w]ord:   "..h)table.insert(r,#r+1,"[e]xpr:   "..i)table.insert(r,#r+1,"[f]ile:   "..j)table.insert(r,#r+1,"[W]ORD:   "..k)vim.api.nvim_buf_set_option(d,"modifiable",true)vim.api.nvim_buf_set_lines(d,0,-1,false,r)vim.api.nvim_buf_set_option(d,"modifiable",false)end;a.single_buffer_selections=function()q("single")end;a.multi_buffer_selections=function()q("multi")end;return a
