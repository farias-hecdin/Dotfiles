local a={warning=vim.diagnostic.severity.WARN,error=vim.diagnostic.severity.ERROR,notice=vim.diagnostic.severity.INFO}return function()return{cmd='terraform',args={'validate','-json'},append_fname=false,stdin=false,stream='both',ignore_exitcode=true,cwd=vim.fs.dirname(vim.api.nvim_buf_get_name(0)),parser=function(b,c)local d=vim.json.decode(b)or{}local e=d['diagnostics']or{}local f={}local g=vim.fn.fnamemodify(vim.api.nvim_buf_get_name(c),':t')for h,i in ipairs(e)do local j=i.summary;if i.detail then j=string.format('%s - %s',j,i.detail)end;local k={message=j,lnum=0,col=0,source='terraform validate',severity=a[i.severity],filename=g}if i.range~=nil and i.range.filename==g then k.col=tonumber(i.range.start.column)-1;k.end_col=tonumber(i.range['end'].column)-1;k.lnum=tonumber(i.range.start.line)-1;k.end_lnum=tonumber(i.range['end'].line)-1;k.filename=tonumber(i.range.filename)end;table.insert(f,k)end;return f end}end
