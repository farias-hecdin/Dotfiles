local a={}local function b(c)return c:match('[^=\'"%s]')~=nil end;function a.parse_args(c)local d,e={},{}local f='in_arg'local g=''local h=''local i=''local function j(k)return c:sub(k+1,k+1)end;local l=1;while l<=#c do local m=c:sub(l,l)if f=='in_arg'then if b(m)then g=g..m elseif m:match('%s')then d[#d+1]=g;f='in_ws'elseif m=='='then h=''local n=j(l)if n=="'"or n=='"'then i=n;l=l+1;f='in_quote'else f='in_value'end end elseif f=='in_ws'then if b(m)then g=m;f='in_arg'end elseif f=='in_value'then if b(m)then h=h..m elseif m:match('%s')then e[g]=h;g=''f='in_ws'end elseif f=='in_quote'then local n=j(l)if m=="\\"and n==i then h=h..n;l=l+1 elseif m==i then e[g]=h;f='in_ws'if n~=''and not n:match('%s')then error('malformed argument: '..n)end else h=h..m end end;l=l+1 end;if f=='in_arg'and#g>0 then d[#d+1]=g elseif f=='in_value'and#g>0 then e[g]=h end;return d,e end;return a
