local a={}a.__index=a;function a.len(b)return vim.fn.strwidth(b)end;function a:new()local c={lines={},hl={},lineNr=0,current=""}setmetatable(c,self)return c end;function a:fix_nl(d)return d:gsub("[\n]","ï¬‹")end;function a:nl()local d=self:fix_nl(self.current)table.insert(self.lines,d)self.current=""self.lineNr=self.lineNr+1 end;function a:set(e,f,b,g)b=self:fix_nl(b)for h=1,e,1 do if not self.lines[h]then self.lines[h]=""end end;local i=a.len(self.lines[e])if i<f then self.lines[e]=self.lines[e]..string.rep(" ",f-i)end;local j=vim.fn.strcharpart(self.lines[e],0,f)local k=vim.fn.strcharpart(self.lines[e],f)self.lines[e]=j..b..k;if not g then return end;self:highlight(e,f,f+a.len(b),"WhichKey"..g)end;function a:highlight(e,l,m,g)local d=self.lines[e]local j=vim.fn.strcharpart(d,0,l)local b=vim.fn.strcharpart(d,0,m)l=vim.fn.strlen(j)m=vim.fn.strlen(b)table.insert(self.hl,{line=e-1,from=l,to=m,group=g})end;return a
