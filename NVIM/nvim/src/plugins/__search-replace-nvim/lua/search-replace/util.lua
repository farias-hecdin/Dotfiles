local a={}local b='"\\/.*$^~[]'a.double_escape=function(c)return vim.fn.escape(vim.fn.escape(c,b),b)end;function a.get_visual_selection(d)local e,f,g,h,i;local j=vim.fn.mode()if j=="v"or j=="V"or j==""then e,f,g,e=unpack(vim.fn.getpos("."))e,h,i,e=unpack(vim.fn.getpos("v"))if j=="V"then g,i=0,999 end else e,f,g,e=unpack(vim.fn.getpos("'<"))e,h,i,e=unpack(vim.fn.getpos("'>"))end;if h<f then f,h=h,f end;if i<g then g,i=i,g end;local k=vim.fn.getline(f,h)local l=#k;if l<=0 then return""end;if l>1 then return nil end;k[l]=string.sub(k[l],1,i)k[1]=string.sub(k[1],g)return table.concat(k,d and"\\n"or"\n")end;return a
