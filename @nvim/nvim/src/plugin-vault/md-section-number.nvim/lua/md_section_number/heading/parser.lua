local a=require("md_section_number.common.stack")local b={}b.ignore_pairs={{"```","```"},{"\\~\\~\\~","\\~\\~\\~"},{"<!--","-->"}}b.heading_pattern="^#+ "function b.add_pairs(c,d)table.insert(b.ignore_pairs,{c,d})end;local function e(f)local g,h=string.find(f,b.heading_pattern)local i=g and h-g or 0;return nil~=g,i end;function b.get_heading_lines(j)if nil==j or#j==0 then return{}end;local k={}local l=a:new({})for m,f in ipairs(j)do for n,o in ipairs(b.ignore_pairs)do local p=vim.fn.match(f,o[1])local q=vim.fn.match(f,o[2],p+1)if o[1]==o[2]then if l:is_empty()then if-1~=p and-1==q then l:push(n)end else if-1~=p and-1==q then if n==l:peek()then l:pop()else l:push(n)end end end end;if o[1]~=o[2]then if-1~=p and-1==q then l:push(n)end;if-1==p and-1~=q then if n==l:peek()then l:pop()end end end end;if l:is_empty()then local r,s=e(f)if r then table.insert(k,{m-1,f,s})end end end;return k end;function b.setup(t)b.ignore_pairs=t.ignore_pairs or b.ignore_pairs end;return b
