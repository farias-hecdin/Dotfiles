local a=require('cmp.utils.spec')local b=require('cmp.utils.keymap')local c=require('cmp.utils.feedkeys')local d=require('cmp.utils.api')describe('api',function()before_each(a.before)describe('get_cursor',function()it('insert-mode',function()local e;c.call(b.t('i\t1234567890'),'nx',function()e=d.get_cursor()end)assert.are.equal(e[2],11)end)it('cmdline-mode',function()local e;b.set_map(0,'c','<Plug>(cmp-spec-spy)',function()e=d.get_cursor()end,{expr=true,noremap=true})c.call(b.t(':\t1234567890'),'n')c.call(b.t('<Plug>(cmp-spec-spy)'),'x')assert.are.equal(e[2],11)end)end)describe('get_screen_cursor',function()it('insert-mode',function()local f;c.call(b.t('iあいうえお'),'nx',function()f=d.get_screen_cursor()end)assert.are.equal(10,f[2])end)it('cmdline-mode',function()local f;b.set_map(0,'c','<Plug>(cmp-spec-spy)',function()f=d.get_screen_cursor()end,{expr=true,noremap=true})c.call(b.t(':あいうえお'),'n')c.call(b.t('<Plug>(cmp-spec-spy)'),'x')assert.are.equal(10,f[2])end)end)describe('get_cursor_before_line',function()it('insert-mode',function()local g;c.call(b.t('i\t1234567890<Left><Left>'),'nx',function()g=d.get_cursor_before_line()end)assert.are.same(g,'\t12345678')end)it('cmdline-mode',function()local g;b.set_map(0,'c','<Plug>(cmp-spec-spy)',function()g=d.get_cursor_before_line()end,{expr=true,noremap=true})c.call(b.t(':\t1234567890<Left><Left>'),'n')c.call(b.t('<Plug>(cmp-spec-spy)'),'x')assert.are.same(g,'\t12345678')end)end)end)
