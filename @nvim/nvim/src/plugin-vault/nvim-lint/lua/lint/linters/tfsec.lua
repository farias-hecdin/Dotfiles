local a={["MEDIUM"]=vim.diagnostic.severity.WARN,["HIGH"]=vim.diagnostic.severity.ERROR}return{cmd='tfsec',stdin=true,args={"-s","-f","json"},stream='stdout',parser=function(b,c)local d={}local e,f=pcall(vim.json.decode,b)if not e then return d end;local g=vim.api.nvim_buf_get_name(c)for h,i in ipairs(f and f.results or{})do if i.location.filename==g then local j={source="tfsec",message=string.format("%s %s",i.description,i.impact),col=i.location.start_line,end_col=i.location.end_line,lnum=i.location.start_line-1,end_lnum=i.location.end_line-1,code=i.rule_id,severity=a[i.severity]}table.insert(d,j)end end;return d end}
