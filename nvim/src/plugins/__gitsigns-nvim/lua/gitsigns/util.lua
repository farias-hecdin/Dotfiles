local a={}function a.path_exists(b)return vim.loop.fs_stat(b)and true or false end;local c;if jit then c=jit.os:lower()end;local d=false;if c then d=c=='linux'or c=='osx'or c=='bsd'else local e=package.cpath:match("%p[\\|/]?%p(%a+)")d=e~="dll"end;function a.dirname(f)return f:match(string.format('^(.+)%s[^%s]+',a.path_sep,a.path_sep))end;function a.file_lines(f)local g={}for h in io.lines(f)do g[#g+1]=h end;return g end;a.path_sep=package.config:sub(1,1)function a.buf_lines(i)local j=vim.api.nvim_buf_get_lines(i,0,-1,false)if vim.bo[i].fileformat=='dos'then for k=1,#j do j[k]=j[k]..'\r'end end;return j end;local function l(m)local n=vim.api.nvim_buf_call(m,function()return vim.fn.bufnr('#')end)if n~=m and n~=-1 then pcall(vim.api.nvim_buf_delete,n,{force=true})end end;function a.buf_rename(i,o)vim.api.nvim_buf_set_name(i,o)l(i)end;function a.set_lines(i,p,q,r)if vim.bo[i].fileformat=='dos'then for k=1,#r do r[k]=r[k]:gsub('\r$','')end end;vim.api.nvim_buf_set_lines(i,p,q,false,r)end;function a.tmpname()if d then return os.tmpname()end;return vim.fn.tempname()end;function a.get_relative_time(s)local t=os.time()local u=t-s;if u==0 then return'a while ago'end;local v=60;local w=v*60;local x=w*24;local y=x*30;local z=y*12;local A=function(B,C,D)local E=math.floor(B/C)if E>1 then D=D..'s'end;return E..' '..D..' ago'end;if u<v then return A(u,1,'second')elseif u<w then return A(u,v,'minute')elseif u<x then return A(u,w,'hour')elseif u<y then return A(u,x,'day')elseif u<z then return A(u,y,'month')else return A(u,z,'year')end end;function a.copy_array(F)local G={}for k,H in ipairs(F)do G[k]=H end;return G end;function a.strip_cr(I)for k=1,#I do if I[k]:sub(-1)~='\r'then return I end end;local J=vim.deepcopy(I)for k=1,#J do J[k]=J[k]:sub(1,-2)end;return J end;function a.calc_base(K)if K and K:sub(1,1):match('[~\\^]')then K='HEAD'..K end;return K end;function a.emptytable()return setmetatable({},{__index=function(L,M)L[M]={}return L[M]end})end;local function N(O,B)if O=='%R'then return a.get_relative_time(B)end;return os.date(O,B)end;function a.expand_format(O,P,Q)local R={}for S=1,20 do local T,U,V,W,X=O:find('(<([^:>]+):?([^>]*)>)')if not V then break end;R[#R+1],O=O:sub(1,T-1),O:sub(U+1)local Y=P[W]if Y then if type(Y)=="table"then Y=table.concat(Y,'\n')end;if vim.endswith(W,'_time')then if X==''then X=Q and'%R'or'%Y-%m-%d'end;Y=N(X,Y)end;V=tostring(Y)end;R[#R+1]=V end;R[#R+1]=O;return table.concat(R,'')end;return a
